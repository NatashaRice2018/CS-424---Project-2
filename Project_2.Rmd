
---
title: "Project 2"
output: html_notebook
---

Libaries and reading in data.

```{r}
library(shiny)
library(shinydashboard)
library(ggplot2)
library(lubridate)
library(DT)
library(jpeg)
library(grid)
library(reshape2)
library(leaflet)

ColNames<- c("FL_DATE","AIRLINE_ID","CARRIER","ORIGIN_AIRPORT_ID","ORIGIN","ORIGIN_CITY_NAME","ORIGIN_STATE_NM","DEST_AIRPORT_ID","DEST_CITY_NAME","DEST_STATE_NM","DEP_TIME","DEP_DELAY","DEP_DELAY_NEW","ARR_TIME","ARR_DELAY","ARR_DELAY_NEW","CANCELLED","CANCELLATION_CODE","DIVERTED","ACTUAL_ELAPSED_TIME","FLIGHTS","DISTANCE","CARRIER_DELAY","WEATHER_DELAY","NAS_DELAY","SECURITY_DELAY","LATE_AIRCRAFT_DELAY")
AprilData<- read.table(file = "April_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(AprilData)<- ColNames
AugustData<- read.table(file = "August_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(AugustData)<- ColNames
DecemberData<- read.table(file = "December_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(DecemberData)<- ColNames
FebuaryData<- read.table(file = "Febuary_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(FebuaryData)<- ColNames
JanuaryData<- read.table(file = "January_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(JanuaryData)<- ColNames
JuneData<- read.table(file = "June_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(JuneData)<- ColNames
JulyData<- read.table(file = "July_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(JulyData)<- ColNames
MarchData<- read.table(file = "March_flights.cleaned.csv", header = FALSE,sep = '\t')
names(MarchData)<- ColNames
MayData<- read.table(file = "May_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(MayData)<- ColNames
NovemberData<- read.table(file = "November_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(NovemberData)<- ColNames
OctoberData<- read.table(file = "October_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(OctoberData)<- ColNames
SeptebmerData<- read.table(file = "September_flights.cleaned.csv", header = FALSE,sep = '\t') 
names(SeptebmerData)<- ColNames

allData <- rbind(AprilData, AugustData, DecemberData, FebuaryData, JanuaryData, JuneData, JulyData, MarchData, MayData, NovemberData, OctoberData, SeptebmerData)
#temp = list.files(pattern="*.csv")
#allData2 <- lapply(temp, read.delim, header = FALSE)
#allData3 <- do.call(rbind, allData2)
```


We will be using August and O'Hare to create functioins, modularity will be added later.

What Yang did:

```{r}

# Arrival of MDW
  Arrival_MDW <- subset(AugustData, AugustData$DEST_AIRPORT_ID== 13232)
  Arrival_MDW$ARR_TIME <- sprintf("%04d", Arrival_MDW$ARR_TIME)
  Arrival_MDW$ARR_TIME_new <- as.POSIXct(paste(Arrival_MDW$FL_DATE, Arrival_MDW$ARR_TIME), format = "%Y-%m-%d %H%M" )
  tem <- Arrival_MDW$ARR_TIME_new 
  Arrival_MDW$hour <- lubridate::hour(tem)
  Arrival_MDW$day <- lubridate::day(tem)
  Arrival_MDW$week <- lubridate::week(tem)
  Arr_table_hour_day <- group_by(Arrival_MDW,day,hour) %>% summarise(number_arrival=n())
  head(Arr_table_hour_day)
  Arrival_MDW$week <- lubridate::week(tem)
  Arr_table_day_week <- group_by(Arrival_MDW,week,day) %>% summarise(number_arrival=n())
  head(Arr_table_day_week)
  
# The delay of Arrival MDW 

Arr_table_delay_day_hour <- group_by(Arrival_MDW,day,hour)  %>% select(DEP_DELAY) %>% filter(DEP_DELAY >0) %>% summarise(number_arrival_delay=n())

# table showing the total number of delays for each hour of the day across that month in MDW and ORD
tem3 <- AugustData

 tem3$ARR_TIME <- sprintf("%04d", tem3$ARR_TIME)
  tem3$ARR_TIME_new <- as.POSIXct(paste(tem3$FL_DATE, tem3$ARR_TIME), format = "%Y-%m-%d %H%M" )

  tem3$hour <- lubridate::hour( tem3$ARR_TIME_new)
  tem3$day <- lubridate::day( tem3$ARR_TIME_new)
  tem3$week <- lubridate::week( tem3$ARR_TIME_new)

MDW_delay_day_hour <- group_by(tem3,day,hour)  %>% select(DEST_AIRPORT_ID,ORIGIN_AIRPORT_ID,ARR_DELAY,DEP_DELAY) %>% filter((ARR_DELAY>0 | DEP_DELAY >0)&&(ORIGIN_AIRPORT_ID==13232 | DEST_AIRPORT_ID == 13232) ) %>% summarise(number_arrival_delay=n())

ORD_delay_day_hour <- group_by(tem3,day,hour)  %>% select(DEST_AIRPORT_ID,ORIGIN_AIRPORT_ID,ARR_DELAY,DEP_DELAY) %>% filter((ARR_DELAY>0 | DEP_DELAY >0)&&(ORIGIN_AIRPORT_ID==13930 | DEST_AIRPORT_ID == 13930) ) %>% summarise(number_arrival_delay=n())

head(MDW_delay_day_hour)
head(ORD_delay_day_hour)

```
